---
import { getFooter } from '../../lib/payload';
import type { Footer } from '../../lib/payload';

interface Props {
  block: {
    infoSide?: {
      heading?: string | null;
      description?: string | null;
      showAddress?: boolean | null;
      showPhone?: boolean | null;
      showEmail?: boolean | null;
      openingHours?: { label: string; hours: string }[] | null;
    };
    formSide?: {
      form?: unknown;
    };
  };
}

const { block } = Astro.props;
const info = block.infoSide ?? {};

// Pull contact details from Footer global
let footer: Footer | null = null;
try { footer = await getFooter(); } catch {}
const addr = footer?.address;
---

<section class="px-5 md:px-10 py-8 lg:py-12">
  <div class="max-w-[1440px] mx-auto grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-14">
    <!-- Info side -->
    <div>
      <h2 class="text-[26px] lg:text-[32px] font-bold text-navy mb-4">{info.heading ?? 'Get in Touch'}</h2>
      {info.description && (
        <p class="text-muted text-[15px] lg:text-[17px] leading-relaxed mb-6">{info.description}</p>
      )}

      <div class="space-y-4 text-[15px] lg:text-[16px]">
        {info.showAddress && addr && (
          <div class="flex gap-3">
            <svg class="w-5 h-5 text-teal shrink-0 mt-0.5" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
            <div class="text-navy">
              {addr.line1 && <div>{addr.line1}</div>}
              {addr.line2 && <div>{addr.line2}</div>}
              {addr.city && addr.postcode && <div>{addr.city}, {addr.postcode}</div>}
            </div>
          </div>
        )}
        {info.showPhone && addr?.phone && (
          <div class="flex gap-3">
            <svg class="w-5 h-5 text-teal shrink-0 mt-0.5" viewBox="0 0 24 24" fill="currentColor"><path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/></svg>
            <a href={`tel:${addr.phone}`} class="text-teal hover:text-navy transition-colors">{addr.phone}</a>
          </div>
        )}
        {info.showEmail && addr?.email && (
          <div class="flex gap-3">
            <svg class="w-5 h-5 text-teal shrink-0 mt-0.5" viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
            <a href={`mailto:${addr.email}`} class="text-teal hover:text-navy transition-colors">{addr.email}</a>
          </div>
        )}
      </div>

      {info.openingHours && info.openingHours.length > 0 && (
        <div class="mt-6">
          <h3 class="font-bold text-navy text-[16px] lg:text-[18px] mb-3">Opening Hours</h3>
          <div class="space-y-1.5">
            {info.openingHours.map((h) => (
              <div class="flex justify-between text-[14px] lg:text-[15px]">
                <span class="text-navy font-medium">{h.label}</span>
                <span class="text-muted">{h.hours}</span>
              </div>
            ))}
          </div>
        </div>
      )}
    </div>

    <!-- Form side (placeholder â€” form builder integration TBD) -->
    <div class="bg-teal-tint rounded-xl lg:rounded-2xl p-6 lg:p-8">
      <h3 class="text-[20px] lg:text-[24px] font-bold text-navy mb-4">Send us a Message</h3>
      <form class="space-y-4">
        <input type="text" placeholder="Your Name" class="w-full px-4 py-3 rounded-xl border border-navy/10 text-[15px] focus:outline-none focus:border-teal" />
        <input type="email" placeholder="Email Address" class="w-full px-4 py-3 rounded-xl border border-navy/10 text-[15px] focus:outline-none focus:border-teal" />
        <input type="text" placeholder="Subject" class="w-full px-4 py-3 rounded-xl border border-navy/10 text-[15px] focus:outline-none focus:border-teal" />
        <textarea placeholder="Your Message" rows="5" class="w-full px-4 py-3 rounded-xl border border-navy/10 text-[15px] focus:outline-none focus:border-teal resize-none"></textarea>
        <button type="submit" class="bg-teal text-white font-bold text-[16px] px-8 py-3 rounded-xl hover:bg-teal/80 transition-colors">Send Message</button>
      </form>
    </div>
  </div>
</section>
